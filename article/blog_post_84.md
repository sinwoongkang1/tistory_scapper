# [Network] 홈 네트워크 구조 변경 및 네트워크 프린터 셋팅

NAS 설치 도중 알게 된 사실로, 우리집 신발장 뒤에 유선 공유기의 존재를 알게 되었고, 이 공유기가 ISP 의 인터넷 신호를 받아서
유선 연결되는 집안의 네트워크 기기들에게 192.168.55.X 의 아이피 주소로 서브넷팅 해주고 있다는 것을 알게 되었다.
이에, 향후 VPN 이용 및 서비스 관리를  위해서 사설 공유기를 하나 영입해서 최상단에 배치해주고( 현재 사용하는 ISP 유선 공유기를 대체), 기존의 공유기는 방으로 가져와 데스크탑과  NAS 에 브릿지 모드로 연결, 다른방에는 그대로 유무선 공유기를 배치 (브릿지모드) 하여, 온 집안에 연결되는 유, 무선 기기를 같은 서브넷으로 서브넷팅 하자!
특히 이번에는 NAS 에 있는 USB 포트에 프린터를 연결하여, 네트워크 프린터를 만들어보도록 하자.
아래는 완성되었을 경우의 홈 네트워크 구상도 이다.
1. 공유기 교체 및 집안 네트워크 서브넷팅 ( with 브릿지 모드)
먼저 IP Time 공유기를 한 대 영입했다. VLAN 및 VPN 서비스가 이용 가능하다고 하니 나중에 한 번 적용해봐야겠다.
신발장 뒤에 있는 공유기를 제거해주고, 새로 영입한 공유기로 교체해주고, 일단 벽면에 있는 이더넷 포트로 데스크탑을 연결하고 설명서에 나와있는대로 일단 인터넷 연결을 완료한다.
이렇게 하니 IP Time 공유기는 집안의 전체 네트워크를 192.168.0.X 로 서브넷팅 해 주었다.
이제 기존에 사용하던 ISP 유선 공유기를 방에 가져와서 벽면에 있는 이더넷 포트에 연결하고, 데스크탑과 NAS 에 연결해준다.
이렇게 하면 아마 공유기가 게이트웨이 모드이기 때문에 데스크탑과 NAS 만 따로 서브넷팅 해 줄것이다. 따라서 이 공유기를 브릿지 모드로 바꿔줘야한다.
벽 - 공유기 - 데스크탑  순으로 연결된 데스크탑에서 게이트웨이 주소를 확인한다.
route -n

netstat -rn

ip route | grep default
이제 다양한 방법으로 게이트웨이 주소를 확인하는 법이 떠오르게 되었다. 아무튼 게이트웨이를 확인한 결과 역시 192.168.55x 로 서브넷팅 되어있는 것을 확인했고, 게이트웨이 주소는 192.168.55.1 이였다.
ISP에서 제공한 공유기들은 대부분 ID 가 admin 이고, 비밀번호는 뒷면 wan 의 시리얼번호(?) 6자리_admin 이다.
ID 와 Password 를 입력하고 (보안 문자는 왜이렇게 잘 안보이냐)설정에 들어가서, 운용모드를 브릿지 모드로 변경해준다.
브릿지 모드는 공유기가 DHCP 기능과 NAT 기능을 사용하지 않고, 접속한 기기들을 상위 공유기에 알려주어 IP 가 할당되도록 하기 때문에, 공장초기화(리셋)를 하지 않으면 이제 설정모드로 다시 진입하기가 힘들다.
설정모드에 제대로 진입이 되지 않아 브라우저의 쿠키와 캐시를 지우고 시도하니 정상적으로 접근이 가능해졌다.
예상대로 유선 공유기가 192.168.0.37 의 아이피 주소를 IP Time 공유기를 통해 배정받았고, 스스로 192.168.55.X 주소를 서브넷팅 하여 게이트웨이 모드로 동작중이였다.
공유기를 브릿지 모드로 변경하고 재부팅하였다. 이제 게이트웨이 주소와 데스크탑, NAS 의 IP 를 확인해보자
(게이트웨이 주소는 192.168.0.1 일 것이고, 192.168.0.X 서브넷으로 통일되어 있을 것이다.)
모두 같은 서브넷으로 서브넷팅 되었다. NAS 의 경우 아이피가 동적으로 변경되면 DDNS 를 이용할 수 없으므로, 다른 아이피들은 동적으로 할당되더라도 192.168.0.20 은 꼭 NAS 에만 적용 되도록 수동 할당을 해 주었다.
NAS의 이름인 ST-102-704 만 수동으로 등록하여 고정해주었다.
2. NAS 와 Printer 연결
이제 프린터의 USB 를 NAS 의 USB 포트에 연결하였다. 패키지 관리자에서 Printer 서버가 있나 찾아봤는데 없어서 제어판에서 프린터 설정을 찾아보려는 찰나, 이미 알아서 네트워크 프린터로 인식하고 설정이 되어있었다.
이제 인쇄 설정에서 네트워크 프린터를 이용 가능한지 확인해보자.
아무 이미지나 선택하고 인쇄를 하려고하니, 데스크탑에 직접 연결되어있지 않은 네트워크 프린터가 목록에 나타났다.
집안에서 사용하는 어떤 기기든, 네트워크 프린터를 이용할 수 있게 되었다!
3.마무리
NAS 에서 네트워크 프린터 서버를 따로 설정해야 한다고 생각했는데, 연결만 하면 알아서 설정이 끝나버리니 뭔가 기분이 좋으면서도 찝찝했다. 그냥 기술의 발전을 누리면 되는거겠지...?
진행 과정 중에, 공유기를 교체하여 연결했는데, 게이트웨이 주소를 입력하니 IP Time 의 게이트웨이로 연결되고, ISP 게이트웨이로 연결이 안되는 오류가 발생했다. 이는 브라우저의 캐시와 쿠키때문에 발생한 문제였는데, 앞으로 인터넷 설정을 할 땐 쿠키와 캐시를 초기화 해줘서 설정시 햇갈리는 일이 없도록 하자!